{% extends 'base.html' %}
{% load static %}

{% block title %}Excluir Usuário{% endblock %}

{% block page_title %}Excluir Usuário{% endblock %}
{% block page_subtitle %}GestControll{% endblock %}

{% block content %}
<div class="page-container">
    <div class="card" style="max-width: 600px; margin: 2rem auto;">
        <h1 style="color: #dc3545; margin-bottom: 1.5rem;">Confirmar exclusão</h1>
        
        <div style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
            <p style="margin: 0; color: #856404; font-weight: 600;">
                Você está prestes a excluir o usuário <strong>{{ user.username }}</strong>.
            </p>
        </div>

        {% if bloqueios %}
            <div style="background: #f8d7da; border: 1px solid #dc3545; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                <p style="margin: 0 0 0.5rem 0; color: #721c24; font-weight: 600;">Não é possível excluir este usuário porque:</p>
                <ul style="margin: 0; padding-left: 1.5rem; color: #721c24;">
                    {% for bloqueio in bloqueios %}
                        <li>{{ bloqueio }}</li>
                    {% endfor %}
                </ul>
                <p style="margin: 1rem 0 0 0; color: #721c24; font-size: 0.9rem;">
                    Remova esses dados primeiro antes de tentar excluir o usuário.
                </p>
            </div>
            <a href="{% if use_central_urls %}{% url 'central_list_users' %}{% else %}{% url 'gestao:list_users' %}{% endif %}" class="btn" style="width: 100%;">Voltar</a>
        {% else %}
            <div style="background: #d1ecf1; border: 1px solid #bee5eb; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                <p style="margin: 0; color: #0c5460;">
                    <strong>Atenção:</strong> Esta ação irá excluir permanentemente:
                </p>
                <ul style="margin: 0.5rem 0 0 1.5rem; color: #0c5460;">
                    <li>O usuário <strong>{{ user.username }}</strong></li>
                    <li>Perfil do usuário</li>
                    <li>Vínculos com empresas</li>
                    <li>Permissões de obra</li>
                    <li>Notificações</li>
                    <li>Lembretes</li>
                </ul>
                <p style="margin: 1rem 0 0 0; color: #0c5460; font-weight: 600;">
                    Esta ação não pode ser desfeita!
                </p>
            </div>

            <form method="post" style="display: flex; gap: 1rem;">
                {% csrf_token %}
                <button type="submit" class="btn" style="background-color: #dc3545; color: white; flex: 1;">
                    Sim, excluir permanentemente
                </button>
                <a href="{% if use_central_urls %}{% url 'central_list_users' %}{% else %}{% url 'gestao:list_users' %}{% endif %}" class="btn btn-secondary" style="flex: 1; text-align: center;">
                    Cancelar
                </a>
            </form>
        {% endif %}
    </div>
</div>
{% endblock %}
